<!DOCTYPE html>
<html lang="ja">
  <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width,initial-scale=1" />
      <meta name="robots" content="noindex, nofollow">
      <title>ページに移動中...</title>
      <link rel="icon" href="favicon.ico" type="image/x-icon"/>
      <link rel="stylesheet" href="redirect.css"/>
      <!-- Google tag (gtag.js) -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-6S8J6J20N4"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-6S8J6J20N4');
      </script>
      <script src="exam_subject_map.js"></script>
  </head>
  <body>
  <div class="card" role="status" aria-live="polite" aria-busy="true">
    <div class="spinner" aria-hidden="true"></div>
    <div class="message">資料を読み込んでいます...</div>
    <div class="sub">少々お待ちください</div>
    <div id="info" class="info"></div>
  </div>
  <footer>
    <div class="license">© <span id="year"></span> 考査対策勉強会 All Rights Reserved</div>
  </footer>

  <script src="exam_subject_map.js"></script>
  
  <script>
  // 年を自動更新
  document.getElementById("year").textContent = new Date().getFullYear();

  // URLパラメータを取得
const params = new URLSearchParams(window.location.search);
const grade   = params.get('grade');
const exam    = params.get('exam');
const subject = params.get('subject');
const file    = params.get('file');
const label   = params.get('label');   // ← ここで受け取る

const gradeLabel   = grade ? grade + "年生" : "";
const examLabel    = examLabelMap[exam] || exam;
const subjectLabel = subjectLabelMap[subject] || subject;

  gtag('event', 'file_open', {
    grade: grade,
    exam: exam,
    subject: subject,
    file: file,
    label: label
  });

// label があれば優先、なければ file の末尾
let fileName;
if (label) {
  fileName = decodeURIComponent(label);
} else if (file) {
  const clean = file.split(/[?#]/)[0];
  const seg   = clean.split('/').filter(Boolean).pop();
  fileName = seg || clean;
} else {
  fileName = "";
}

const infoText = `
  <p>学年: ${gradeLabel}</p>
  <p>考査: ${examLabel}</p>
  <p>教科: ${subjectLabel}</p>
  <p>ファイル: ${fileName}</p>
`;
document.getElementById("info").innerHTML = infoText;


setTimeout(() => {
  if (file) window.location.href = file;
}, 1000);

  </script>
</body>
</html>